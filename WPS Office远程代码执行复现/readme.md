0x00 漏洞描述

    WPS office是中国金山软件(Kingsoft)公司的一种办公软件提供文件处理功能。近日，网传WPS Office for windows 版本存在0day 漏洞，攻击者可以利用该 day 漏洞在受害者主机上执行任意恶意文件；目前已经发现了该0day漏洞的在野利用。大家都在传，我也来水一篇文章了，踩了一些坑，在此记录一下。遇到了大反转，文章后半部分有分析。
    WPS Office  for  windows的内置浏览器存在逻辑漏洞，攻击者可以利用该漏洞专门构造出恶意文档，受害者打开该文档并点击文档中的URL链接或包含了超级链接的图片时，存在漏润版本的WPS office会通过内嵌浏览器加载该链接，接着该链接中js脚本会通过cefQuery调用WPS端内API下载文件并打开文件，进而导致恶意文件在受害者电脑上被运行。


0x01 漏洞版本

     Windows 10 专业版
     版本 22H2
     OS版本 19045.3208
    11.1.0.10667  没成功
    11.1.0.13703  没成功
    11.1.0.14309  没成功
    11.1.0.12300  成功
0x02 分析

   1.多个WPS Office 2023 个人版<11.1.0.15120 都未复现，poc目前无法证实文档里藏的图片

   2.也有人说这是个老洞，吾爱破解去年有讨论过：https://www.52pojie.cn/thread-1670740-1-1.html
   


